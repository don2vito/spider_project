

# ä¸å†™ä¸€è¡Œä»£ç ä¸Šçº¿ä¸€æ¬¾å°å·¥å…·ï¼Œå¿«é€Ÿæå–è§„å¾‹æ–‡æœ¬ä¸­çš„æ•°å­—

åŠå¹´å‰ï¼Œæˆ‘å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œ[æ­£åˆ™å¤§æ³•å¥½ï¼Œå¿«é€Ÿæå–è§„å¾‹æ–‡æœ¬ä¸­çš„æ•°å­—](https://mp.weixin.qq.com/s/VFqRVoIQOPekLO1UPs6t6w)ï¼Œå½“æ—¶é‡åˆ°çš„åœºæ™¯éœ€è¦æŠŠé’‰é’‰é‡Œæ¯å¤©å›ºå®šæ ¼å¼çš„æ–‡å­—æ¨é€å†…å®¹è¿›è¡Œæå–ï¼Œä¿å­˜æˆä¸º Excel æ–‡ä»¶ï¼Œä½¿ç”¨çš„å·¥å…·æ˜¯ Python çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚

åæ¥ï¼Œä¸ºäº†å’Œå…¬å¸å¸¸ç”¨çš„ Excel å…¬å¼æ¨¡æ¿ç›¸è¡”æ¥ï¼Œæˆ‘åˆ©ç”¨ AI çš„è¾…åŠ©ï¼Œé€šè¿‡ VBA çš„æ–¹å¼å†™äº†ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œæ¥æŠ½å–å½“å¤©é’‰é’‰æ¨é€çš„æ–‡æœ¬å†…å®¹ã€‚è‡ªå®šä¹‰å‡½æ•°çš„å†…å®¹å¦‚ä¸‹ï¼Œå¤§å®¶æœ‰å…´è¶£å¯ä»¥å€Ÿç€ä¹‹å‰é‚£ç¯‡æ–‡ç« çš„æ ¼å¼è‡ªå·±æ“ä½œä¸€ä¸‹ã€‚ä½¿ç”¨çš„æ—¶å€™è¿™æ ·å†™å…¬å¼ï¼Œ`=Myreg(è´´å…¥é’‰é’‰æ–‡æœ¬çš„å•å…ƒæ ¼,"[\d.-]+",1)`ï¼Œå°±èƒ½è‡ªåŠ¨è¿”å›æŠ½å–ç›¸åº”å­—æ®µçš„æ•°ç»„ã€‚

```basic
Function Myreg(StringValue As String, pattern As String, mode As Long) As Variant
    ' åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
    Dim regex As Object
    Set regex = CreateObject("VBScript.RegExp")
    ' è®¾ç½®æ­£åˆ™è¡¨è¾¾å¼å±æ€§
    regex.Global = True
    regex.IgnoreCase = False
    ' æ ¹æ®æ¨¡å¼æ‰§è¡Œä¸åŒçš„æ“ä½œ
    Select Case mode
        Case 1 ' æå–
            Dim matches As Object
            regex.pattern = pattern
            Set matches = regex.Execute(StringValue)
            ' å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²
            If matches.Count = 0 Then
                Myreg = ""
                Exit Function
            End If
           
            ' å°†åŒ¹é…é¡¹æ”¶é›†åˆ°æ•°ç»„ä¸­
            Dim result As Variant
            ReDim result(1 To matches.Count)
            Dim i As Long
            For i = 1 To matches.Count
                result(i) = matches(i - 1).Value
            Next i
            Myreg = result
            
        Case 2 ' æ›¿æ¢
            ' ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åŒ¹é…é¡¹
            regex.pattern = pattern
            Myreg = regex.Replace(StringValue, "")
        
        Case 3 ' åˆ¤æ–­
            ' æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼
            regex.pattern = pattern
            If regex.Test(StringValue) Then
                Myreg = True
            Else
                Myreg = False
            End If
            
        Case Else
            ' æ— æ•ˆæ¨¡å¼ï¼Œè¿”å›é”™è¯¯å€¼
            Myreg = CVErr(xlErrValue)
            
    End Select
    
    ' æ¸…ç†å¯¹è±¡
    Set regex = Nothing
End Function
```

è¿™ä¸¤ç§æ–¹æ³•éƒ½æœ‰å…¶å±€é™æ€§ã€‚Python æ–¹æ³•å¯ä»¥æ‰¹é‡å¤„ç†æ–‡æœ¬ï¼Œä½†æ˜¯å¤ªâ€œé‡â€äº†ï¼Œæ¯æ¬¡éƒ½è¦èŠ±æ—¶é—´å¯åŠ¨ã€è¿è¡Œï¼Œåªå¤„ç†ä¸€å¤©æ•°æ®çš„åœºæ™¯â€œæ€§ä»·æ¯”â€æœ‰ç‚¹ä½ã€‚VBA æ–¹æ³•ä¸€ä¸ªå•å…ƒæ ¼åªèƒ½å¤„ç†ä¸€å¤©çš„æ•°æ®ï¼Œä¸æ–¹ä¾¿æ‰¹é‡åŒ–å¤„ç†ã€‚

é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§é—¨æ§›ä½ã€å¯¹äºå•ç‹¬å’Œæ‰¹é‡æ•°æ®éƒ½èƒ½å¤Ÿçµæ´»å¤„ç†çš„æ–¹æ³•å‘¢ï¼ŒæŒ‰ç…§ä»¥å¾€ç»éªŒï¼Œæˆ‘ä¼šåšä¸ªå¯ä»¥äº¤äº’çš„ç•Œé¢ï¼Œå› ä¸ºä¸æ‡‚å‰ç«¯ï¼Œå°±ä¼šä½¿ç”¨ streamlit æ¥å®ç°ã€‚ç°åœ¨æœ‰äº† AI ï¼Œé‚£å°±æ–¹ä¾¿å¾ˆå¤šäº†ï¼Œæˆ‘å¯ä»¥è®©å¤§æ¨¡å‹å¸®æˆ‘å®ç°ï¼Œä¹Ÿå°±ä¸ç”¨æ›²çº¿æ•‘å›½äº†ï¼Œçœäº‹å¾ˆå¤šã€‚

è¯´å¹²å°±å¹²ï¼Œå…ˆæ¥ä¸€æ®µæç¤ºè¯ã€‚

> ä½ æ˜¯ä¸€ä¸ªå‰ç«¯å¤§å¸ˆï¼Œç°åœ¨æˆ‘ä¸Šä¼ äº†ä¸€ä»½ã€Šå¿«å›¢å›¢æ•°æ®ã€‹çš„æ–‡ä»¶ï¼Œéœ€æ±‚åšä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œæˆ‘æŠŠã€Šå¿«å›¢å›¢æ•°æ®ã€‹ä¸­çš„æ–‡æœ¬å†…å®¹è´´å…¥ï¼Œè‡ªåŠ¨å¸®æˆ‘æå–æ•°æ®ï¼Œæå–çš„æ•°æ®å…·æœ‰å›ºå®šçš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
>
>  â€œå¿«å›¢å›¢æ—¥æŠ¥ï¼š{æ—¥æœŸ} ä¸œæ–¹è´­ç‰©ï¼ˆè®¢é˜…é¢†ğŸ§§ï¼‰,è®¢è´­æ•°é‡ï¼š{ä¸œæ–¹è´­ç‰©è®¢è´­æ•°é‡}å•ï¼Œè®¢è´­äººæ•°ï¼š{ä¸œæ–¹è´­ç‰©è®¢è´­äººæ•°}ä¸ªï¼Œè®¢è´­é‡‘é¢ï¼š{ä¸œæ–¹è´­ç‰©è®¢è´­é‡‘é¢}å…ƒï¼Œåˆ©æ¶¦ï¼š{ä¸œæ–¹è´­ç‰©è®¢è´­åˆ©æ¶¦}å…ƒï¼› ã€ä¸œæ–¹è´­ç‰©ã€‘ç•ªèŒ„å›¢,è®¢è´­æ•°é‡ï¼š{ç•ªèŒ„å›¢è®¢è´­æ•°é‡}å•ï¼Œè®¢è´­äººæ•°ï¼š{ç•ªèŒ„å›¢è®¢è´­äººæ•°}ä¸ªï¼Œè®¢è´­é‡‘é¢ï¼š{ç•ªèŒ„å›¢è®¢è´­é‡‘é¢}å…ƒï¼Œåˆ©æ¶¦ï¼š{ç•ªèŒ„å›¢è®¢è´­åˆ©æ¶¦}å…ƒã€‚â€ 
>
> éœ€è¦è½¬æ¢æˆè¡¨æ ¼ï¼Œè¡¨æ ¼å­—æ®µä¸ºï¼š{æ—¥æœŸ}{è®¢è´­æ•°é‡}{è®¢è´­äººæ•°}{è®¢è´­é‡‘é¢}{è®¢è´­åˆ©æ¶¦} ã€‚
>
> - {è®¢è´­æ•°é‡} = {ä¸œæ–¹è´­ç‰©è®¢è´­æ•°é‡} + {ç•ªèŒ„å›¢è®¢è´­æ•°é‡} 
>
> - {è®¢è´­äººæ•°} = {ä¸œæ–¹è´­ç‰©è®¢è´­äººæ•°} + {ç•ªèŒ„å›¢è®¢è´­äººæ•°} 
>
> -  {è®¢è´­é‡‘é¢} = {ä¸œæ–¹è´­ç‰©è®¢è´­é‡‘é¢} + {ç•ªèŒ„å›¢è®¢è´­é‡‘é¢} 
>
> - {è®¢è´­åˆ©æ¶¦} = {ä¸œæ–¹è´­ç‰©è®¢è´­åˆ©æ¶¦} + {ç•ªèŒ„å›¢è®¢è´­åˆ©æ¶¦} 
>
> - åšä¸€ä¸ªæ£€æŸ¥ï¼Œå¦‚æœæœ‰å¤šä¸ª{æ—¥æœŸ}é‡å¤å‡ºç°ï¼Œåº”å½“å–æœ€åä¸€æ¬¡å‡ºç°çš„{æ—¥æœŸ}åŠå…¶ä»–å­—æ®µæ•°æ®ã€‚
>
>   
>
>   å°†è½¬æ¢åçš„è¡¨æ ¼åœ¨å‰ç«¯å±•ç°ï¼ŒåŒæ—¶æä¾›ä¸‹è½½åŠŸèƒ½ï¼Œä¸‹è½½è¡¨æ ¼çš„æ–‡ä»¶åä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼šå¿«å›¢å›¢æ•°æ®_{å¼€å§‹æ—¥æœŸ}-{ç»“æŸæ—¥æœŸ}ã€‚
>
>   è¯·å¸®å¿™å®Œæˆæ­¤é¡¹éœ€æ±‚ã€‚

ååˆ†é’Ÿä¹‹åï¼Œå°±ç”Ÿæˆäº†ä¸€ä¸ªç®€å•çš„é¡µé¢ï¼Œè¿˜è›®å¥½çœ‹çš„ã€‚

![](https://cdn.jsdelivr.net/gh/don2vito/picgo_warehouse@main/202508221254748.png)

ç»è¿‡æµ‹è¯•ï¼Œæ•°æ®è®¡ç®—é€»è¾‘å‡†ç¡®ï¼Œæ•ˆæœä¹Ÿå¾ˆä¸é”™ï¼Œæ“ä½œç®€å•ï¼Œäº¤äº’å‹å¥½ï¼Œä¸€ä¸ªå°å·¥å…·å°±å®Œæˆäº†ã€‚

æ•°æ®å·²ç»è¿‡è„±æ•å¤„ç†ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹æ•ˆæœã€‚

![](https://cdn.jsdelivr.net/gh/don2vito/picgo_warehouse@main/202508221254692.png)

![](https://cdn.jsdelivr.net/gh/don2vito/picgo_warehouse@main/202508221254651.png)